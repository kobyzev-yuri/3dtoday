# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

## üéØ –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º 3D-–ø–µ—á–∞—Ç–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –∞–≥–µ–Ω—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º RAG (Retrieval Augmented Generation) –∏ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.

## üìä Dataflow –¥–∏–∞–≥—Ä–∞–º–º–∞

### –û—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö (–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞)

```mermaid
flowchart TD
    Start([–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å]) --> Input{–¢–∏–ø –≤–≤–æ–¥–∞}
    
    Input -->|–¢–µ–∫—Å—Ç| TextInput[–¢–µ–∫—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å]
    Input -->|–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ| ImageInput[–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–µ—Ñ–µ–∫—Ç–∞]
    Input -->|–¢–µ–∫—Å—Ç + –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ| BothInput[–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤–≤–æ–¥]
    
    TextInput --> Orchestrator[Orchestrator Agent]
    ImageInput --> VisionAgent[Vision Agent]
    BothInput --> VisionAgent
    
    VisionAgent -->|llava Ollama| VisionAnalysis[–ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è]
    VisionAnalysis -->|Fallback| GeminiAPI[Gemini —á–µ—Ä–µ–∑ ProxyAPI]
    GeminiAPI --> VisionResult[–†–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞:<br/>problem_type, symptoms]
    VisionAnalysis --> VisionResult
    
    VisionResult --> Orchestrator
    BothInput --> Orchestrator
    
    Orchestrator --> SessionContext[SessionContext<br/>- –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞<br/>- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ<br/>- –°–æ—Å—Ç–æ—è–Ω–∏–µ]
    
    Orchestrator --> DiagnosticAgent[Diagnostic Agent]
    DiagnosticAgent -->|–ò—Å–ø–æ–ª—å–∑—É–µ—Ç SessionContext| RAGQuery[–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ RAG –∑–∞–ø—Ä–æ—Å–∞]
    
    RAGQuery --> RetrievalAgent[Retrieval Agent]
    RetrievalAgent --> VectorDB[(Qdrant<br/>Vector DB)]
    
    VectorDB -->|–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫| SearchResults[–†–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Å—Ç–∞—Ç—å–∏<br/>+ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ]
    
    SearchResults --> LLM[LLM<br/>Ollama/ProxyAPI]
    SessionContext --> LLM
    
    LLM --> Answer[–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç<br/>+ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏]
    
    Answer --> UserResponse([–û—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é])
    
    style Start fill:#e1f5ff
    style UserResponse fill:#e1f5ff
    style VectorDB fill:#fff4e1
    style LLM fill:#e8f5e9
    style SessionContext fill:#f3e5f5
```

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–µ–π –≤ KB

```mermaid
flowchart TD
    Start([–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä]) --> InputMethod{–ú–µ—Ç–æ–¥ –≤–≤–æ–¥–∞}
    
    InputMethod -->|URL| URLParser[URL Parser]
    InputMethod -->|–§–∞–π–ª| FileParser[File Parser]
    InputMethod -->|–†—É—á–Ω–æ–π –≤–≤–æ–¥| ManualInput[Manual Input]
    
    URLParser --> LLMAnalyzer[LLM URL Analyzer<br/>GPT-4o/Gemini]
    FileParser --> DocumentParser[Document Parser]
    ManualInput --> Validation[–í–∞–ª–∏–¥–∞—Ü–∏—è]
    
    LLMAnalyzer --> ParsedDoc[–†–∞—Å–ø–∞—Ä—Å–µ–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç]
    DocumentParser --> ParsedDoc
    
    ParsedDoc --> LibrarianAgent[KB Librarian Agent]
    
    LibrarianAgent --> RelevanceCheck[–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏]
    RelevanceCheck -->|–†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ| MetadataExtraction[–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö]
    RelevanceCheck -->|–ù–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ| Reject[–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ]
    
    MetadataExtraction --> Summary[–ì–µ–Ω–µ—Ä–∞—Ü–∏—è summary]
    Summary --> AdminReview[–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º]
    
    AdminReview -->|–û–¥–æ–±—Ä–µ–Ω–æ| Indexer[Article Indexer]
    AdminReview -->|–û—Ç–∫–ª–æ–Ω–µ–Ω–æ| Reject
    
    Indexer --> EmbeddingGen[–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤]
    EmbeddingGen --> VectorDB[(Qdrant<br/>Vector DB)]
    
    VectorDB --> Success([–°—Ç–∞—Ç—å—è –¥–æ–±–∞–≤–ª–µ–Ω–∞])
    
    style Start fill:#e1f5ff
    style Success fill:#e1f5ff
    style VectorDB fill:#fff4e1
    style LibrarianAgent fill:#e8f5e9
```

## ü§ñ –ê–≥–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1. KB Librarian Agent (–ê–≥–µ–Ω—Ç-–∫—É—Ä–∞—Ç–æ—Ä KB)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –¶–µ–Ω–∑—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∏–∑–≤–ª–µ—á–µ–Ω–Ω–æ–π –ø–∞—Ä—Å–µ—Ä–æ–º, –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å—Ç–∞—Ç–µ–π –¥–ª—è KB.

**–ó–∞–¥–∞—á–∏:**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è summary –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  KB Librarian Agent                     ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Content Validator                   ‚îÇ
‚îÇ  ‚îÇ   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏            ‚îÇ
‚îÇ  ‚îÇ   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞                 ‚îÇ
‚îÇ  ‚îÇ   - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –º—É—Å–æ—Ä–∞                 ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Metadata Extractor                  ‚îÇ
‚îÇ  ‚îÇ   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö      ‚îÇ
‚îÇ  ‚îÇ     –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö                         ‚îÇ
‚îÇ  ‚îÇ   - –í–∞–ª–∏–¥–∞—Ü–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö              ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Summary Generator                   ‚îÇ
‚îÇ  ‚îÇ   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫—Ä–∞—Ç–∫–æ–≥–æ –∏–∑–ª–æ–∂–µ–Ω–∏—è      ‚îÇ
‚îÇ  ‚îÇ   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –∏ —Ä–µ—à–µ–Ω–∏–π      ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ Relevance Filter                    ‚îÇ
‚îÇ      - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–æ—Ä–æ–≥—É —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `backend/app/agents/kb_librarian.py`

### 2. Diagnostic Agent (–ê–≥–µ–Ω—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–∞–ø—Ä–æ—Å–∞ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.

**–ó–∞–¥–∞—á–∏:**
- ‚úÖ –ê–Ω–∞–ª–∏–∑ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ RAG –∑–∞–ø—Ä–æ—Å–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π
- ‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤

**–ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã:**

1. –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–º–æ–¥–µ–ª—å –ø—Ä–∏–Ω—Ç–µ—Ä–∞, –º–∞—Ç–µ—Ä–∏–∞–ª, –∏—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞)
3. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ RAG –∑–∞–ø—Ä–æ—Å–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
4. –ü–æ–∏—Å–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π –≤ KB
5. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏
6. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É—Ç–æ—á–Ω–µ–Ω–∏–π

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `backend/app/main.py` (endpoint `/api/diagnose`)

### 3. Vision Agent (–ê–≥–µ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–µ—Ñ–µ–∫—Ç–æ–≤ –ø–µ—á–∞—Ç–∏.

**–ó–∞–¥–∞—á–∏:**
- ‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø—Ä–æ–±–ª–µ–º—ã –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å–∏–º–ø—Ç–æ–º–æ–≤
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–ø–∏—Å–∞–Ω–∏—è –¥–µ—Ñ–µ–∫—Ç–∞

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è (–®–ê–ì 8)

## üîß –°–µ—Ä–≤–∏—Å—ã

### 1. RAG Service

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫ –≤ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –ë–î.

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º (–º–æ–¥–µ–ª—å –ø—Ä–∏–Ω—Ç–µ—Ä–∞, –º–∞—Ç–µ—Ä–∏–∞–ª, —Ç–∏–ø –ø—Ä–æ–±–ª–µ–º—ã)
- –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `backend/app/services/rag_service.py`

### 2. Vector DB Service

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–∞–±–æ—Ç–∞ —Å Qdrant (–≤–µ–∫—Ç–æ—Ä–Ω–∞—è –ë–î).

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Å—Ç–∞—Ç–µ–π —Å —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏
- –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏
- –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç—É –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `backend/app/services/vector_db.py`

### 3. LLM Client

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∫–ª–∏–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å LLM.

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã:**
- Ollama (–ª–æ–∫–∞–ª—å–Ω–æ)
- OpenAI —á–µ—Ä–µ–∑ ProxyAPI
- Gemini —á–µ—Ä–µ–∑ ProxyAPI

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback:** –ü—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ –¥–æ—Å—Ç—É–ø–Ω—ã–π.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `backend/app/services/llm_client.py`

### 4. Article Indexer

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Å—Ç–∞—Ç–µ–π –≤ –≤–µ–∫—Ç–æ—Ä–Ω—É—é –ë–î.

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –¥–ª—è —Ç–µ–∫—Å—Ç–∞ —Å—Ç–∞—Ç—å–∏
2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–µ—Å–ª–∏ –µ—Å—Ç—å)
3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Qdrant —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `backend/app/services/article_indexer.py`

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –°—Ç–∞—Ç—å—è –≤ KB

```json
{
  "article_id": "stringing_pla_ender3",
  "title": "–ö–∞–∫ —É—Å—Ç—Ä–∞–Ω–∏—Ç—å stringing –ø—Ä–∏ –ø–µ—á–∞—Ç–∏ PLA",
  "content": "–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç—å–∏...",
  "url": "https://3dtoday.ru/...",
  "section": "–¢–µ—Ö–Ω–∏—á–∫–∞",
  "date": "2024-01-15",
  "relevance_score": 0.95,
  "quality_score": 0.90,
  "problem_type": "stringing",
  "printer_models": ["Ender-3", "Ender-3 V2"],
  "materials": ["PLA"],
  "symptoms": ["–Ω–∏—Ç–æ—á–∫–∏ –º–µ–∂–¥—É –¥–µ—Ç–∞–ª—è–º–∏", "—Å–æ–ø–ª–∏"],
  "solutions": [
    {
      "parameter": "retraction_length",
      "value": 6,
      "unit": "mm",
      "description": "–£–≤–µ–ª–∏—á—å—Ç–µ retraction –¥–æ 6 –º–º"
    }
  ],
  "abstract": "–ö—Ä–∞—Ç–∫–æ–µ –∏–∑–ª–æ–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—å–∏...",
  "embedding": [0.123, 0.456, ...]  // 768-–º–µ—Ä–Ω—ã–π –≤–µ–∫—Ç–æ—Ä
}
```

## üîÑ –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã

1. **–í–≤–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** ‚Üí –¢–µ–∫—Å—Ç/–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ/–ö–æ–º–±–∏–Ω–∞—Ü–∏—è
2. **–û–±—Ä–∞–±–æ—Ç–∫–∞** ‚Üí Vision Agent (–µ—Å–ª–∏ –µ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ)
3. **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞** ‚Üí Diagnostic Agent
4. **–ü–æ–∏—Å–∫ –≤ KB** ‚Üí RAG Service ‚Üí Qdrant
5. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞** ‚Üí LLM —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π
6. **–û—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é** ‚Üí –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ + —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—å–∏

1. **–í–≤–æ–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞** ‚Üí URL/–§–∞–π–ª/–†—É—á–Ω–æ–π –≤–≤–æ–¥
2. **–ü–∞—Ä—Å–∏–Ω–≥** ‚Üí LLM URL Analyzer / Document Parser
3. **–ê–Ω–∞–ª–∏–∑** ‚Üí KB Librarian Agent
4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏** ‚Üí –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–æ—Ä–æ–≥—É
5. **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö** ‚Üí –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
6. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º** ‚Üí –û–¥–æ–±—Ä–µ–Ω–∏–µ/–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ
7. **–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è** ‚Üí Article Indexer ‚Üí Qdrant

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Ä–∞–±–æ—Ç–µ –∞–≥–µ–Ω—Ç–æ–≤: —Å–º. –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –≤ `backend/app/agents/`
- –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Å–µ—Ä–≤–∏—Å–∞—Ö: —Å–º. –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –≤ `backend/app/services/`
- Dataflow –¥–∏–∞–≥—Ä–∞–º–º—ã: —Å–º. `DATAFLOW_DIAGRAM.md` (–≤ archive/)
