# –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫ –≤ KB

## üìã –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –∏ –ø–æ–∏—Å–∫–∞ —Å—Ç–∞—Ç–µ–π –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π –ø—Ä–æ–µ–∫—Ç–∞ 3dtoday.

## üõ†Ô∏è –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. ArticleIndexer (`article_indexer.py`)

–°–µ—Ä–≤–∏—Å –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ —Å—Ç–∞—Ç–µ–π –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –≤–µ–∫—Ç–æ—Ä–Ω—É—é –ë–î.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

- `index_article()` - –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –æ–¥–Ω–æ–π —Å—Ç–∞—Ç—å–∏
- `index_image()` - –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `batch_index_articles()` - –ø–∞–∫–µ—Ç–Ω–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Å—Ç–∞—Ç–µ–π

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```python
from services.article_indexer import get_article_indexer

indexer = get_article_indexer()

article = {
    "article_id": "stringing_pla_001",
    "title": "–ö–∞–∫ —É—Å—Ç—Ä–∞–Ω–∏—Ç—å stringing",
    "content": "...",
    "problem_type": "stringing",
    "printer_models": ["Ender-3"],
    "materials": ["PLA"]
}

result = await indexer.index_article(article)
```

### 2. RAGService (`rag_service.py`)

–°–µ—Ä–≤–∏—Å –¥–ª—è RAG-–ø–æ–∏—Å–∫–∞ –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π —Å –≥–∏–±—Ä–∏–¥–Ω—ã–º –ø–æ–∏—Å–∫–æ–º.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

- `search()` - –±–∞–∑–æ–≤—ã–π –ø–æ–∏—Å–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
- `hybrid_search()` - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫ —Å –±—É—Å—Ç–∏–Ω–≥–æ–º

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```python
from services.rag_service import get_rag_service

rag_service = get_rag_service()

# –ë–∞–∑–æ–≤—ã–π –ø–æ–∏—Å–∫
results = await rag_service.search(
    query="stringing —Å–æ–ø–ª–∏",
    filters={"problem_type": "stringing", "materials": ["PLA"]},
    limit=5
)

# –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫ —Å –±—É—Å—Ç–∏–Ω–≥–æ–º
results = await rag_service.hybrid_search(
    query="warping PETG",
    filters={"materials": ["PETG"]},
    limit=5,
    boost_filters=True
)
```

## üîç –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫

–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç:

1. **–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫** - —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º
2. **–§–∏–ª—å—Ç—Ä—ã –ø–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º** - —Ç–æ—á–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ:
   - `problem_type` (stringing, warping, layer_separation, etc.)
   - `printer_models` (Ender-3, Anycubic Kobra, etc.)
   - `materials` (PLA, PETG, ABS, etc.)
3. **–ë—É—Å—Ç–∏–Ω–≥ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏** - —É–≤–µ–ª–∏—á–µ–Ω–∏–µ score –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∏–ª—å—Ç—Ä–∞–º

## üìä –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ç—å–∏

```python
{
    "article_id": "stringing_pla_001",  # –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
    "title": "–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç–∞—Ç—å–∏",         # –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
    "content": "–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ç–∞—Ç—å–∏",      # –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
    "url": "https://3dtoday.ru/...",     # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
    "problem_type": "stringing",          # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
    "printer_models": ["Ender-3"],        # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
    "materials": ["PLA"],                # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
    "symptoms": ["–Ω–∏—Ç–æ—á–∫–∏", "—Å–æ–ø–ª–∏"],    # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
    "solutions": [...],                   # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
    "section": "–¢–µ—Ö–Ω–∏—á–∫–∞",               # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
    "date": "2024-01-15",                 # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
    "relevance_score": 0.95               # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –∏ –ø–æ–∏—Å–∫–∞:

```bash
python3 backend/app/services/test_indexing.py
```

–¢–µ—Å—Ç –≤–∫–ª—é—á–∞–µ—Ç:
- –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—é 3 —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ç–∞—Ç–µ–π
- –ü–æ–∏—Å–∫ –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º –∑–∞–ø—Ä–æ—Å–∞–º
- –ü—Ä–æ–≤–µ—Ä–∫—É —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ú–æ–¥–µ–ª—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –≤—Ä–µ–º—è)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è CPU –¥–ª—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–µ—Å–ª–∏ CUDA –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞)
- –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –±—É—Å—Ç–∏–Ω–≥ –∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º


